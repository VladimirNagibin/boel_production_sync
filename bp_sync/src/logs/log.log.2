2025-08-12 13:51:09,668 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,671 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,674 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,674 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,675 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,678 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,678 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,680 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,682 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,682 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,686 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,688 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,688 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,691 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,694 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,694 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,697 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,700 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,700 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,703 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,706 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,706 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,709 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,712 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,712 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,715 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,718 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,719 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,722 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,724 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,725 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,727 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,731 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,731 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,734 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,737 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,738 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,739 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,743 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,745 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,748 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,753 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,753 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,755 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,758 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,759 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,761 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,764 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,765 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,769 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,773 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,774 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,776 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,779 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,779 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,780 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,782 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,783 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,785 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,787 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,787 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,789 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,793 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,793 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,794 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,797 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,798 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,801 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,803 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,803 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,806 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,808 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,809 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,810 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,814 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,815 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,817 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,820 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,821 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,824 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,825 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,826 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,829 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,832 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,832 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,833 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,840 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,840 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,844 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,847 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,847 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,850 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,853 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,853 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,855 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,858 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,859 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,861 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,867 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,868 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,870 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,874 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,874 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,876 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,882 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,882 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,885 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,888 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,888 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,889 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,896 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,896 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,899 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,903 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,903 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,904 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,912 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,912 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,913 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,916 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,916 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,919 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,924 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,925 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,926 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,932 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,932 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,933 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,938 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,938 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,942 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,946 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,946 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,948 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,953 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,953 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,957 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,964 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,964 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,965 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,969 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,969 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,971 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,975 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,976 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,977 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,985 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,985 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,988 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,991 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,991 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:09,992 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:09,997 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:09,997 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,005 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,007 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,007 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,009 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,012 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,013 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,017 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,021 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,022 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,026 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,030 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,031 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,034 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,044 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,045 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,047 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,049 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,049 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,052 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,054 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,054 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,056 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,059 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,059 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,063 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,067 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,068 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,071 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,074 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,075 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,078 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,081 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,082 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,084 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,089 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,089 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,091 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,098 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,098 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,099 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,103 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,103 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,107 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,110 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,110 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,112 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,115 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,116 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,117 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,119 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,119 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,123 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,126 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,126 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,128 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,131 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,131 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,134 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,136 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,139 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,140 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,143 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,144 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,145 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,149 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,149 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,150 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,155 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,156 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,158 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,161 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,161 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,162 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,167 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,167 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,169 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,172 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,172 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,175 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,185 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,185 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,188 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,192 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,193 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,195 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,197 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,197 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,200 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,202 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,203 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,204 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,207 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,207 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,208 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,213 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,213 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,215 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,217 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,218 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,221 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,226 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,226 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,228 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,231 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,231 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,233 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,235 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,235 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,238 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,240 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,240 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,241 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,245 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,245 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,247 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,252 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,252 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,254 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,257 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,257 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,260 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,264 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,264 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,266 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,268 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,269 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,273 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,275 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,275 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,277 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,279 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,280 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,281 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,284 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,284 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,289 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,291 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,291 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,295 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,298 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,299 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,300 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,303 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,304 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,307 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,310 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,310 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,312 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,314 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,315 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,317 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,320 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,320 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,322 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,324 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,325 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,326 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,329 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,329 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,331 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,334 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,334 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,337 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,339 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,340 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,342 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,344 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,344 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,348 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,350 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,351 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,352 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,355 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,355 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,357 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,361 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,361 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,363 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,364 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,365 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,366 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,369 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,369 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,371 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,375 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,375 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,377 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,379 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
2025-08-12 13:51:10,379 - sync - ERROR - Unexpected error: Token retrieval failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/app/services/token_services/token_storage.py", line 55, in get_token
    encrypted_token = await self.redis.get(key)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "/usr/local/lib/python3.12/site-packages/redis/asyncio/connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -3 connecting to redis:6379. Temporary failure in name resolution.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/app/services/decorators.py", line 19, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/base_bitrix_services.py", line 126, in get
    response = await self.bitrix_client.call_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_api_client.py", line 46, in call_api
    access_token = await self.oauth_client.get_valid_token()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/bitrix_services/bitrix_oauth_client.py", line 33, in get_valid_token
    if access_token := await self.token_storage.get_token("access_token"):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/app/services/token_services/token_storage.py", line 62, in get_token
    raise ConnectionError("Token retrieval failed") from e
ConnectionError: Token retrieval failed
2025-08-12 13:51:10,381 - sync - INFO - Starting deal import from Bitrix
2025-08-12 13:51:10,383 - sync - ERROR - Redis get error for access_token:215:B24: Error -3 connecting to redis:6379. Temporary failure in name resolution.
